<html>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="Aneureka" />
  <meta name="description" content="è¦æŠ€è‰ºè¶…ç¾¤ï¼Œè¦äºˆäººæ¸©æš–ã€‚" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta
    property="og:title"
    content="Type traits ç»ƒä¹ ï¼šç¼–è¯‘æœŸå¿«æ’ Â· æ•£è½çš„å¶å­"
  />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://www.aneureka.cn/type-traits-practice-quick-sort-2023-07-31/index.html" />
  <meta property="og:description" content="è¦æŠ€è‰ºè¶…ç¾¤ï¼Œè¦äºˆäººæ¸©æš–ã€‚" />
  <meta property="og:image" content="https://www.aneureka.cn/img/favicon.ico" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@Aneureka" />
  <meta name="twitter:url" content="https://www.aneureka.cn/type-traits-practice-quick-sort-2023-07-31/index.html" />
  <meta name="twitter:title" content="æ•£è½çš„å¶å­" />
  <meta name="twitter:description" content="è¦æŠ€è‰ºè¶…ç¾¤ï¼Œè¦äºˆäººæ¸©æš–ã€‚" />
  <meta name="twitter:image" content="https://www.aneureka.cn/img/cover.png" />
  <title>
    Type traits ç»ƒä¹ ï¼šç¼–è¯‘æœŸå¿«æ’ Â· æ•£è½çš„å¶å­
  </title>
  
  <link rel="icon" href="/img/favicon.ico" />
  <link rel="apple-touch-icon" href="/img/favicon.ico" />
  <link rel="bookmark" href="/img/favicon.ico" />
  <link rel="shortcut icon" href="/img/favicon.ico" />
  
  <link
    rel="stylesheet"
    href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"
  />
  
<link rel="stylesheet" href="/css/blog.css">

  
<link rel="stylesheet" href="/css/global.css">

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="æ•£è½çš„å¶å­" type="application/atom+xml">
</head>

  <body>
    <div class="blog-header section">
  <nav>
    <div class="container main header">
      <a href="/">
        <img class="logo" src="/img/favicon.ico" />
      </a>
      <div class="menu">
        
        <a class="menu-item" href="/">
          <span class="menu-item-text">æ•£è½çš„å¶å­</span>
        </a>
        
      </div>
    </div>
  </nav>
</div>
 <div class="section">
  <div class="container main post">
    
    <!-- Title -->
    <h2 class="title">Type traits ç»ƒä¹ ï¼šç¼–è¯‘æœŸå¿«æ’</h2>
    <!-- Date and Author -->
    <p class="subtitle is-7 has-text-grey">
      2023-07-31 by Aneureka
    </p>
    
    <!-- Content -->
    <article class="markdown-body"><p><em>å‰æ’æé†’ï¼šæœ¬æ–‡ä»…åšå­¦ä¹ äº¤æµä¹‹ç”¨ï¼Œå®é™…é¡¹ç›®ä¸­å¦‚æœ‰æ¡ä»¶è¯·å°½é‡ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/language/constraints">Constraints and concepts</a> (since C++20) ã€‚</em></p>
<p>æ—¢<a href="https://www.aneureka.cn/type-traits-practice-tuple-type-2023-07-30/">ä¸Šå›</a>æˆ‘ä»¬é€šè¿‡å¯¹ tuple çš„ç±»å‹æ“ä½œï¼Œå°è¯•äº†ä¸€ä¸‹ Type traits ä¹‹åï¼Œæœ¬æ–‡æˆ‘ä»¬å¼€å§‹åŠ ç‚¹å¼ºåº¦ï¼Œå®ç°ä¸€ä¸ªåŸºäºæ¨¡æ¿å…ƒç¼–ç¨‹çš„ç¼–è¯‘æœŸå¿«æ’ï¼ˆä¸å¦¨åœ¨è¿™é‡Œæ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœä½ æ¥å®ç°ï¼Œå¤§æ¦‚åˆ†æˆå“ªå‡ ä¸ªæ­¥éª¤å‘¢ï¼Ÿè·Ÿè¿è¡Œæ—¶çš„å¿«æ’æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿï¼‰</p>
<p>æœ¬æ–‡æ¶‰åŠåˆ°çš„æ‰€æœ‰ä»£ç å‡åœ¨ <a target="_blank" rel="noopener" href="https://godbolt.org/z/6xM3znx17">godbolts</a> ä¸­ï¼Œå¤§å®¶æœ‰éœ€è¦å¯ä»¥è‡ªå–~</p>
<h2 id="å®šä¹‰æ•°æ®ç±»å‹"><a href="#å®šä¹‰æ•°æ®ç±»å‹" class="headerlink" title="å®šä¹‰æ•°æ®ç±»å‹"></a>å®šä¹‰æ•°æ®ç±»å‹</h2><p>æ€è€ƒä¸€ä¸‹ï¼Œæˆ‘ä»¬è¦æ’åºçš„æ˜¯ä»€ä¹ˆæ•°æ®ï¼Œè¿™äº›æ•°æ®å­˜åœ¨å“ªé‡Œï¼Ÿ</p>
<p>ç­”æ¡ˆæ¯”è¾ƒæ˜¾ç„¶ï¼Œå­˜åœ¨æ¨¡æ¿å‚æ•°é‡Œï¼Œä½œä¸ºç»“æ„ä½“çš„ç¼–è¯‘æœŸä¿¡æ¯ã€‚</p>
<pre><code class="cpp">template &lt;int... Ns&gt;  // ä¸ºç®€åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ int ä½œä¸ºå¾…æ’åºçš„æ•°æ®ç±»å‹
struct Nums &#123;&#125;;
</code></pre>
<p>åœ¨å¼€å§‹ç¼–å†™å¿«æ’ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€äº›æ“ä½œ Nums çš„æ“ä½œï¼Œæ¯”å¦‚å°†ä¸¤ä¸ª Nums åˆå¹¶èµ·æ¥ã€‚</p>
<pre><code class="cpp">// ä»¥ä¸‹è¿™æ®µä»£ç ä½ åº”è¯¥å¯ä»¥å¾ˆå¿«ç†è§£äº†
template &lt;typename T1, typename T2&gt;
struct Concat &#123;&#125;;

template &lt;int... Ns1, int... Ns2&gt;
struct Concat&lt;Nums&lt;Ns1...&gt;, Nums&lt;Ns2...&gt;&gt; &#123;
  using type = Nums&lt;Ns1..., Ns2...&gt;;
&#125;;
</code></pre>
<h2 id="æ‹†è§£å¿«æ’æµç¨‹"><a href="#æ‹†è§£å¿«æ’æµç¨‹" class="headerlink" title="æ‹†è§£å¿«æ’æµç¨‹"></a>æ‹†è§£å¿«æ’æµç¨‹</h2><p><em>æ¸©é¦¨æé†’ï¼šå¦‚æœè¿˜ä¸äº†è§£å¿«æ’çš„æµç¨‹ï¼Œå¯ä»¥å‚è€ƒä¸‹<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Quicksort">ç»´åŸºç™¾ç§‘</a>ï¼Œå†é˜…è¯»å‰©ä¸‹çš„å†…å®¹ã€‚</em></p>
<p>ç¼–è¯‘æœŸå¿«æ’æ•´ä½“æµç¨‹è·Ÿä¼ ç»Ÿå¿«æ’å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼š</p>
<ol>
<li>åŸºäºæŸä¸ª pivotï¼ˆä¸€èˆ¬å–é¦–ä¸ªå…ƒç´ ï¼‰ å°†å½“å‰æ•°æ®åˆ’åˆ†ä¸ºå·¦å³ä¸¤éƒ¨åˆ†æˆ–å·¦ã€ä¸­ã€å³ä¸‰éƒ¨åˆ†ï¼ˆæœ¬æ–‡ä½¿ç”¨ä¸‰è·¯å¿«æ’ï¼‰</li>
<li>å¯¹ 1 ä¸­åˆ’åˆ†çš„å·¦ã€å³éƒ¨åˆ†é€’å½’æ‰§è¡Œå¿«æ’ï¼Œç›´åˆ°æ•°ç»„é•¿åº¦å°äº 2</li>
</ol>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¼–è¯‘æœŸå¿«æ’æ‹†è§£æˆä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>åˆ’åˆ†æ•°æ®</li>
<li>é€’å½’æ‰§è¡Œ</li>
</ol>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†é’ˆå¯¹è¿™ä¸¤ä¸ªæ­¥éª¤åˆ†åˆ«æ€è€ƒå’Œå®ç°ã€‚</p>
<h2 id="åˆ’åˆ†æ•°æ®"><a href="#åˆ’åˆ†æ•°æ®" class="headerlink" title="åˆ’åˆ†æ•°æ®"></a>åˆ’åˆ†æ•°æ®</h2><p>ç›´æ¥å– Nums ä¸­çš„æ•°æ®åš pivot åˆ’åˆ†å¤æ‚åº¦ä¼šé«˜ä¸€äº›ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè€ƒè™‘åœ¨ç»™å®šä¸€ä¸ª pivot å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œæ€æ ·æŠŠå°† Nums åˆ’åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹å®šä¹‰ Divide ç±»æ¨¡æ¿äº†ã€‚</p>
<pre><code class="cpp">template &lt;int Pivot, typename T&gt;
struct Divide &#123;&#125;;

template &lt;int Pivot, int... Ns&gt;
struct Divide&lt;Pivot, Nums&lt;Ns...&gt;&gt; &#123;&#125;;

template &lt;int Pivot&gt;
struct Divide&lt;Pivot, Nums&lt;&gt;&gt; &#123;
  using left = Nums&lt;&gt;;
  using mid = Nums&lt;&gt;;
  using right = Nums&lt;&gt;;
&#125;;
</code></pre>
<p>å†™å‡ºä¸Šé¢ä¸‰ä¸ªæ¨¡æ¿è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå…³é”®åœ¨äºæ€æ ·æŠŠ Divide çš„é€’æ¨å…³ç³»æ‰¾å‡ºæ¥ã€‚å…¶å®ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬åªè¦ä¸æ–­èƒå– Nums ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå°†å…¶ä¸ pivot æ¯”è¾ƒï¼Œæ ¹æ®æ¯”è¾ƒç»“æœåˆ†ç±»è®¨è®ºå†™å‡ºé€’æ¨å¼å°±å¯ä»¥äº†~</p>
<p>å®ç°è§ä»¥ä¸‹ä»£ç ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº† <a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/types/conditional">std::conditional_t</a>ï¼ˆè‡ªå·±å®ç°ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼‰</p>
<pre><code class="cpp">template &lt;int Pivot, int N0, int... Ns&gt;
struct Divide&lt;Pivot, Nums&lt;N0, Ns...&gt;&gt; &#123;
  using left =
      std::conditional_t&lt;
          N0 &lt; Pivot,
        typename Concat&lt;Nums&lt;N0&gt;,
                        typename Divide&lt;Pivot, Nums&lt;Ns...&gt;&gt;::left
                       &gt;::type,
        typename Divide&lt;Pivot, Nums&lt;Ns...&gt;&gt;::left
          &gt;;
  using mid = 
      std::conditional_t&lt;
        N0 == Pivot,
        typename Concat&lt;Nums&lt;N0&gt;, typename Divide&lt;Pivot, Nums&lt;Ns...&gt;&gt;::mid&gt;::type,
        typename Divide&lt;Pivot, Nums&lt;Ns...&gt;&gt;::mid
      &gt;;
  using right =
      std::conditional_t&lt;
        Pivot &lt; N0,
        typename Concat&lt;Nums&lt;N0&gt;, typename Divide&lt;Pivot, Nums&lt;Ns...&gt;&gt;::right&gt;::type,
        typename Divide&lt;Pivot, Nums&lt;Ns...&gt;&gt;::right
      &gt;;
&#125;;
</code></pre>
<p>æµ‹è¯•ä¸€ä¸‹ï¼Œç¬¦åˆé¢„æœŸï¼š</p>
<pre><code class="cpp">print_type&lt;Divide&lt;5, Nums&lt;1, 5&gt;&gt;::left&gt;();   // Nums&lt;1&gt;
print_type&lt;Divide&lt;5, Nums&lt;1, 5&gt;&gt;::mid&gt;();    // Nums&lt;5&gt;
print_type&lt;Divide&lt;5, Nums&lt;1, 5&gt;&gt;::right&gt;();  // Nums&lt;&gt;
print_type&lt;Divide&lt;5, Nums&lt;1, 2, 9, 4, 5, 5, 6, 7, 8&gt;&gt;::left&gt;();   // Nums&lt;1, 2, 4&gt;
print_type&lt;Divide&lt;5, Nums&lt;1, 2, 9, 4, 5, 5, 6, 7, 8&gt;&gt;::mid&gt;();    // Nums&lt;5, 5&gt;
print_type&lt;Divide&lt;5, Nums&lt;1, 2, 9, 4, 5, 5, 6, 7, 8&gt;&gt;::right&gt;();  // Nums&lt;9, 6, 7, 8&gt;
</code></pre>
<p>ä»¥ä¸Šå®ç°çš„ Divide æ¨¡æ¿ä¸­ï¼Œpivot æ˜¯ç”±å¤–éƒ¨ä¼ å…¥çš„ï¼Œä½†å¿«æ’éœ€è¦ç›´æ¥å– Nums ä¸­çš„å…ƒç´ ä½œä¸º pivotï¼Œæ€ä¹ˆå®ç°å‘¢ï¼Ÿ</p>
<p>å…¶å®åªè¦ç»§æ‰¿ä¸€ä¸‹ç°æœ‰çš„ Divideï¼Œæˆ‘ä»¬å°±èƒ½å¾ˆè½»æ¾åœ°å†™ä¸€ä¸ªå–ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸º pivot çš„ DivideInplace äº†~</p>
<pre><code class="cpp">template &lt;typename T&gt;
struct DivideInplace &#123;&#125;;

template &lt;&gt;
struct DivideInplace&lt;Nums&lt;&gt;&gt; : Divide&lt;0, Nums&lt;&gt;&gt; &#123;&#125;;

template &lt;int N0, int... Ns&gt;
struct DivideInplace&lt;Nums&lt;N0, Ns...&gt;&gt; : Divide&lt;N0, Nums&lt;N0, Ns...&gt;&gt; &#123;&#125;;
</code></pre>
<p>å†æµ‹è¯•ä¸€ä¸‹ï¼Œä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚</p>
<pre><code class="cpp">print_type&lt;DivideInplace&lt;Nums&lt;1, 2, 3&gt;&gt;::left&gt;();   // Nums&lt;&gt;
print_type&lt;DivideInplace&lt;Nums&lt;1, 2, 3&gt;&gt;::mid&gt;();    // Nums&lt;1&gt;
print_type&lt;DivideInplace&lt;Nums&lt;1, 2, 3&gt;&gt;::right&gt;();  // Nums&lt;2, 3&gt;
print_type&lt;DivideInplace&lt;Nums&lt;3, 2, 1&gt;&gt;::left&gt;();   // Nums&lt;2, 1&gt;
print_type&lt;DivideInplace&lt;Nums&lt;3, 2, 1&gt;&gt;::mid&gt;();    // Nums&lt;3&gt;
print_type&lt;DivideInplace&lt;Nums&lt;3, 2, 1&gt;&gt;::right&gt;();  // Nums&lt;&gt;
</code></pre>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æŠŠæœ€éš¾çš„ä¸€æ­¥â€”â€”åˆ’åˆ†æ•°æ®å†™å®Œäº†ï¼Œæ¥ä¸‹æ¥å®é™…ä¸Šå°±æ¯”è¾ƒç®€å•äº†ã€‚</p>
<h2 id="é€’å½’æ‰§è¡Œ"><a href="#é€’å½’æ‰§è¡Œ" class="headerlink" title="é€’å½’æ‰§è¡Œ"></a>é€’å½’æ‰§è¡Œ</h2><p>é¦–å…ˆæˆ‘ä»¬è¿˜æ˜¯å®šä¹‰ä¸€ä¸ªå¿«æ’æ¨¡æ¿ï¼Œå¹¶è€ƒè™‘å½“ Nums ä¸ºç©ºæˆ–åªæœ‰ä¸€ä¸ªå…ƒç´ çš„æƒ…å†µã€‚</p>
<pre><code class="cpp">template &lt;typename T&gt;
struct QuickSort &#123;&#125;;

template &lt;&gt;
struct QuickSort&lt;Nums&lt;&gt;&gt; &#123;
  using type = Nums&lt;&gt;;
&#125;;

template &lt;int N&gt;
struct QuickSort&lt;Nums&lt;N&gt;&gt; &#123;
  using type = Nums&lt;N&gt;;
&#125;;
</code></pre>
<p>ç„¶åå°±æ˜¯é€’æ¨å¼äº†ï¼Œä¹Ÿä¸å¤ªå¤æ‚ï¼š</p>
<pre><code class="cpp">template &lt;int... Ns&gt;
struct QuickSort&lt;Nums&lt;Ns...&gt;&gt; &#123;
  using divide = DivideInplace&lt;Nums&lt;Ns...&gt;&gt;;
  using left = typename QuickSort&lt;typename divide::left&gt;::type;
  using mid = typename divide::mid;
  using right = typename QuickSort&lt;typename divide::right&gt;::type;
  using type = typename Concat&lt;typename Concat&lt;left, mid&gt;::type, right&gt;::type;
&#125;;
</code></pre>
<p>æœ€ç»ˆæµ‹è¯•ï¼Œæ²¡é—®é¢˜ï¼</p>
<pre><code class="cpp">print_type&lt;QuickSort&lt;Nums&lt;&gt;&gt;::type&gt;();          // Nums&lt;&gt;
print_type&lt;QuickSort&lt;Nums&lt;3&gt;&gt;::type&gt;();         // Nums&lt;3&gt;
print_type&lt;QuickSort&lt;Nums&lt;1, 1&gt;&gt;::type&gt;();      // Nums&lt;1, 1&gt;
print_type&lt;QuickSort&lt;Nums&lt;1, 2, 3&gt;&gt;::type&gt;();   // Nums&lt;1, 2, 3&gt;
print_type&lt;QuickSort&lt;Nums&lt;3, 2, 1&gt;&gt;::type&gt;();   // Nums&lt;1, 2, 3&gt;
print_type&lt;QuickSort&lt;Nums&lt;5, 1, 2, 9, 4, 5, 6, 7, 8&gt;&gt;::type&gt;();  // Nums&lt;1, 2, 4, 5, 5, 6, 7, 8, 9&gt;
</code></pre>
<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å®Œå·¥~ è¦ä¸ä½ å†™ä¸ªç¼–è¯‘æœŸå½’å¹¶æ’åºç»ƒç»ƒæ‰‹æ€ä¹ˆæ · ğŸ¥µ</p>
</article>
    
    <div id="giscus-container" class="giscus"></div>
    
    
  </div>
</div>


<script
  src="https://giscus.app/client.js"
  data-repo="aneureka/Aneureka.github.io"
  data-repo-id="MDEwOlJlcG9zaXRvcnkxMjY0Nzk4MzY="
  data-category="Announcements"
  data-category-id="DIC_kwDOB4nt3M4CX9S7"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="bottom"
  data-theme="light_protanopia"
  data-lang="en"
  crossorigin="anonymous"
  async
></script>



 <!-- Footer -->
<footer class="section">
  <div class="container main footer">
    <ul class="contact-list">
      
      <li class="contact-list-item">
        <a href="mailto:aneureka2@gmail.com">Email</a>
        <a href="mailto:aneureka2@gmail.com">ğŸ’Œ</a>
      </li>
      
      <li class="contact-list-item">
        <a target="_blank" rel="noopener" href="https://github.com/aneureka">Github</a>
        <a target="_blank" rel="noopener" href="https://github.com/aneureka">â­ï¸</a>
      </li>
      
      <li class="contact-list-item">
        <a target="_blank" rel="noopener" href="https://twitter.com/Aneureka">Twitter</a>
        <a target="_blank" rel="noopener" href="https://twitter.com/Aneureka">ğŸ¦</a>
      </li>
      
    </ul>
    <div class="copyright">
      æ•£è½çš„å¶å­ Â· 2017 -
      <script>
        document.write(new Date().getFullYear());
      </script>
      Â· <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn">ç²¤ICPå¤‡2021087752å·</a>
    </div>
  </div>
</footer>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<script>
  hljs.highlightAll();
</script>


    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-56506279-6");
    </script>
  </body>
</html>
